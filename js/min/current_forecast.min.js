import{settings,weatherIcons,cachedLang,airQualityColors,nightWeatherIcons,unitsTypes,calcTemp,calcWind}from"./read_storage.min.js";function currentForecast(data){console.log(data);const location=data.location,weather=data.weather.current,pollution=data.pollution.list[0],aria=cachedLang.aria,daytime=weather.dt>weather.sunrise&&weather.dt<weather.sunset?"day":"night",date=new Date(1e3*weather.dt).toLocaleDateString("pl-pl",{timeZone:data.weather.timezone,day:"2-digit",month:"2-digit",year:"numeric"}),sunriseTime=new Date(1e3*weather.sunrise).toLocaleTimeString("pl-PL",{timeZone:data.weather.timezone,hour:"2-digit",minute:"2-digit",hourCycle:settings.clockMode}),sunsetTime=new Date(1e3*weather.sunset).toLocaleTimeString("pl-PL",{timeZone:data.weather.timezone,hour:"2-digit",minute:"2-digit",hourCycle:settings.clockMode}),daytimeDuration=Math.round((weather.sunset-weather.sunrise)/60),currentDaytime=Math.round((weather.dt-weather.sunrise)/60),id=weather.weather[0].id,icon="night"==daytime&&nightWeatherIcons.has(id)?nightWeatherIcons.get(id):weatherIcons.get(id);document.querySelector(".cf-weather-desc-data").innerHTML=cachedLang.weather[`desc${weather.weather[0].id}`],document.querySelector(".cf-city-info").ariaLabel=`${aria["weather-current-desc"]} ${location.name}, ${location.country}`,document.querySelector(".cf-temp-data").innerHTML=calcTemp(weather.temp,!1),document.querySelector(".units-temp-data").innerHTML=`${unitsTypes.get(settings.units).temp}`,document.querySelector(".cf-fl-temp-data").innerHTML=cachedLang.generic["weather-temp-feels-like"].replace("%temp",`${calcTemp(weather.feels_like)}`),document.querySelector(".city-date-data").innerHTML=date,document.querySelector(".cf-humid-data").innerHTML=`${weather.humidity} %`,document.querySelector(".cf-cloud-data").innerHTML=`${weather.clouds} %`,document.querySelector(".cf-dewpt-data").innerHTML=`${calcTemp(weather.dew_point)}`,document.querySelector(".cf-wind-deg-data").innerHTML=`${360==weather.wind_deg?0:weather.wind_deg} °`;for(let[key,value]of Object.entries(pollution.components))document.querySelectorAll(`.cf-${key}-data`).forEach(e=>{e.innerHTML=`${value} μg/m³`,e.ariaLabel=`${value} ${aria["unit-aq"]}`});document.querySelectorAll(".cf-wind-speed-data").forEach(e=>{e.innerHTML=calcWind(weather.wind_speed),e.ariaLabel=`${calcWind(weather.wind_speed,!1)} ${aria[`unit-${unitsTypes.get(settings.units).wind_speed}`]}`}),document.querySelectorAll(".cf-temp").forEach(e=>{e.title=e.ariaLabel=aria["weather-temp-desc"].replace("%temp",`${calcTemp(weather.temp)}`)}),document.querySelectorAll(".country-flag-data").forEach(e=>{e.classList.forEach(el=>{el.startsWith("fi-")&&e.classList.replace(el,`fi-${location.country.toLowerCase()}`)})}),document.querySelectorAll(".cf-press-data").forEach(e=>{e.innerHTML=`${weather.pressure} hPa`,e.ariaLabel=`${weather.pressure} ${aria["unit-hPa"]}`}),document.querySelectorAll(".cf-aqi-desc").forEach(e=>{e.innerHTML=cachedLang.airQualityDesc[pollution.main.aqi-1],e.style.color=airQualityColors[pollution.main.aqi-1]}),document.querySelectorAll(".cf-weather-icon-data").forEach(e=>{e.classList.forEach(el=>{el.startsWith("bi-")&&e.classList.replace(el,icon)})}),document.querySelectorAll(".city-name-data").forEach(e=>{e.innerHTML=location.local_names&&location.local_names[settings.lang]||location.name}),document.querySelectorAll(".country-code-data").forEach(e=>{e.innerHTML=location.country}),document.querySelectorAll(".cf-sunrise-data").forEach(e=>{e.innerHTML=sunriseTime,e.title=e.ariaLabel=`${aria["weather-sunrise-at"]} ${sunriseTime}`}),document.querySelectorAll(".cf-sunset-data").forEach(e=>{e.innerHTML=sunsetTime,e.title=e.ariaLabel=`${aria["weather-sunset-at"]} ${sunsetTime}`}),document.querySelectorAll(".cf-sun-box").forEach(e=>{let percentage=currentDaytime<30&currentDaytime>=0?currentDaytime/30:daytimeDuration-currentDaytime>=0&daytimeDuration-currentDaytime<30?(daytimeDuration-currentDaytime)/30:"day"==daytime?1:0;e.style.backgroundColor=`hsl(200, ${30+70*percentage}%, ${10+75*percentage}%)`,document.querySelector(".cf-sun-path").style.borderColor="day"==daytime?"black":"white"}),weather.snow?(document.querySelectorAll(".cf-snow-hideable").forEach(e=>{e.classList.remove("box-hidden"),e.ariaHidden=!1}),document.querySelectorAll(".cf-snow-data").forEach(e=>{e.innerHTML=`${weather.snow["1h"]} mm`})):document.querySelectorAll(".cf-snow-hideable").forEach(e=>{e.classList.add("box-hidden"),e.ariaHidden=!0}),weather.rain?(document.querySelectorAll(".cf-rain-hideable").forEach(e=>{e.classList.remove("box-hidden"),e.ariaHidden=!1}),document.querySelectorAll(".cf-rain-data").forEach(e=>{e.innerHTML=`${weather.rain["1h"]} mm`})):document.querySelectorAll(".cf-rain-hideable").forEach(e=>{e.classList.add("box-hidden"),e.ariaHidden=!0}),weather.wind_gust?(document.querySelectorAll(".cf-gust-hideable").forEach(e=>{e.classList.remove("box-hidden"),e.ariaHidden=!1}),document.querySelectorAll(".cf-wind-gust-data").forEach(e=>{e.innerHTML=calcWind(weather.wind_gust),e.ariaLabel=`${calcWind(weather.wind_gust)} ${aria[`unit-${unitsTypes.get(settings.units).wind_speed}`]}`})):document.querySelectorAll(".cf-gust-hideable").forEach(e=>{e.classList.add("box-hidden"),e.ariaHidden=!0}),"day"==daytime?document.querySelectorAll(".cf-sun-path").forEach(e=>{e.style.transform=`rotate(${currentDaytime/daytimeDuration*130-65}deg)`}):document.querySelectorAll(".cf-sun-path").forEach(e=>{e.style.transform="rotate(-80deg)"})}export{currentForecast};